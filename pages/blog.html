<!--
 ╔════════════════════════════════════════════════════════════════════════════╗
 ║                                                                            ║
 ║   ███████╗ ██████╗ ███████╗██╗ █████╗                                      ║
 ║   ██╔════╝██╔═══██╗██╔════╝██║██╔══██╗                                     ║
 ║   ███████╗██║   ██║█████╗  ██║███████║                                     ║
 ║   ╚════██║██║   ██║██╔══╝  ██║██╔══██║                                     ║
 ║   ███████║╚██████╔╝██║     ██║██║  ██║                                     ║
 ║   ╚══════╝ ╚═════╝ ╚═╝     ╚═╝╚═╝  ╚═╝                                     ║
 ║                                                                            ║
 ║   If you found this... nice, but don't mess up with me.                    ║
 ║  -- "You shall not pass!" --                                               ║
 ╚════════════════════════════════════════════════════════════════════════════╝
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Blog Network - Stefano Ortolini</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        :root {
            --color-dark-teal: #65558F;  
            --color-burgundy: #21005D;   
            --color-salmon-pink: #7D5260; 
            --color-mustard-yellow: #FFD8E4; 
            --color-light-blue: #FFFFFF; 
            --color-pale-pink: #FFFFFF;   
            --color-text-dark: #1D192B;  
            --color-text-light: #F7F2FA; 
            --radius-sm: 8px;
            --radius-md: 15px;
            --radius-lg: 25px;
        }
        
        body {
            margin: 0;
            overflow: hidden;
            background: var(--color-pale-pink);
            font-family: 'Roboto', sans-serif;
        }
        
        .node {
            cursor: pointer;
            transition: all 0.3s ease;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        }
        
        .node:hover {
            filter: brightness(1.2) drop-shadow(0 6px 12px rgba(0, 0, 0, 0.2));
            stroke-width: 3;
        }
        
        .link {
            stroke: var(--color-dark-teal);
            stroke-opacity: 0.2;
            fill: none;
        }
        
        .node-text {
            fill: var(--color-text-dark);
            text-anchor: middle;
            pointer-events: none;
            transition: opacity 0.3s ease;
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
        }
        
        #info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: var(--color-burgundy);
            font-size: 14px;
            font-weight: 700;
            font-family: 'Montserrat', sans-serif;
            background: var(--color-text-light);
            padding: 10px 15px;
            border-radius: var(--radius-md);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 10;
            max-width: 200px;
        }
        
        #back-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--color-mustard-yellow);
            color: var(--color-dark-teal);
             padding: 10px 20px;
            border-radius: var(--radius-md);
            text-decoration: none;
            font-weight: bold;
            font-family: 'Roboto', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            font-size: 14px;
            transition: background-color 0.3s ease-in-out, transform 0.2s ease-out, box-shadow 0.3s ease-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }
        
        /* Mobile adjustments */
        @media (max-width: 768px) {
            #info {
                font-size: 12px;
                padding: 8px 12px;
                max-width: 150px;
                top: 10px;
                left: 10px;
            }
            
            #back-btn {
                font-size: 12px;
                padding: 8px 16px;
                top: auto;
                bottom: 10px;
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <div id="info">Scroll to zoom • Click to read • Drag to explore</div>
    <a href="../index.html" id="back-btn">Back to Home</a>
    <svg id="network"></svg>
    
    <script>
        const width = window.innerWidth;
        const height = window.innerHeight;
        
        // Responsive sizing based on viewport
        const isMobile = width < 768;
        const minNodeSpacing = isMobile ? 80 : 120;
        const minLayerSpacing = isMobile ? width / 4 : width / 6;
        
        // Define neural network structure
        const layers = [
            { // Input layer
                nodes: [
                    { id: 'input1', title: '-', size: 'large', link: '../articles/no_brain.html' },
                    { id: 'input2', title: '-', size: 'large', link: '../articles/no_brain.html' },
                    { id: 'input3', title: '-', size: 'medium', link: '../articles/no_brain.html' },
                ]
            },
            { // Hidden layer 1
                nodes: [
                    { id: 'hidden1_1', title: '-', size: 'small', link: '../articles/no_brain.html' },
                    { id: 'hidden1_2', title: '-', size: 'small', link: '../articles/no_brain.html' },
                    { id: 'hidden1_3', title: '-', size: 'medium', link: '../articles/no_brain.html' },
                    { id: 'hidden1_4', title: 'Gaze Tracking', size: 'large', link: '../articles/gaze_tracking.html' },
                ]
            },
            { // Hidden layer 2
                nodes: [
                    { id: 'hidden2_1', title: '-', size: 'small', link: '../articles/no_brain.html' },
                    { id: 'hidden2_2', title: 'Entrepreneurship', size: 'medium', link: '../articles/ignifughino.html' },
                    { id: 'hidden2_3', title: 'Bachelor Knowledge', size: 'large', link: '../articles/bachelor_knowledge.html' },
                    { id: 'hidden2_4', title: 'Bachelor Thesis', size: 'large', link: '../articles/bachelor_thesis.html' },
                    { id: 'hidden2_5', title: 'MasterZ', size: 'medium', link: '../articles/masterz.html' },
                ]
            },
            { // Hidden layer 3
                nodes: [
                    { id: 'hidden3_1', title: 'HeartGuard - Paper', size: 'medium', link: '../articles/heart_disease.html' },
                    { id: 'hidden3_2', title: 'Industry 4.0', size: 'medium', link: '../articles/industry.html' },
                    { id: 'hidden3_3', title: 'Master Knowledge', size: 'large', link: '../articles/master_knowledge.html' },
                    { id: 'hidden3_4', title: '-', size: 'small', link: '../articles/no_brain.html' },
                ]
            },
            { // Output layer
                nodes: [
                    { id: 'output1', title: 'Master Thesis', size: 'large', link: '../articles/master_thesis.html' },
                    { id: 'output2', title: 'Current Work', size: 'large', link: '../articles/working_technogym.html' },
                ]
            }
        ];
        
        // Calculate optimal spacing
        const maxNodesInLayer = Math.max(...layers.map(l => l.nodes.length));
        const nodeSpacing = Math.max(minNodeSpacing, (height * 0.8) / maxNodesInLayer);
        const layerSpacing = Math.max(minLayerSpacing, (width * 0.8) / (layers.length + 1));
        
        // Create nodes with positions
        const nodes = [];
        const sizeMap = {
            small: isMobile ? 20 : 25,
            medium: isMobile ? 30 : 35,
            large: isMobile ? 40 : 45
        };
        
        // Color palette matching the main site
        const nodeColors = [
            '#65558F', // dark-teal
            '#4A148C', // burgundy
            '#7D5260', // salmon-pink
            '#FFD8E4', // mustard-yellow (lighter shade for visibility)
            '#65558F'  // back to dark-teal
        ];
        
        // Calculate total network dimensions
        const networkWidth = layerSpacing * (layers.length - 1);
        const networkHeight = nodeSpacing * (maxNodesInLayer - 1);
        
        // Center the network in the viewport
        const xOffset = (width - networkWidth) / 2;
        const yOffset = (height - networkHeight) / 2;
        
        layers.forEach((layer, layerIndex) => {
            const x = xOffset + layerSpacing * layerIndex;
            const layerHeight = layer.nodes.length * nodeSpacing;
            const layerYOffset = yOffset + (networkHeight - layerHeight) / 2;
            
            layer.nodes.forEach((node, nodeIndex) => {
                nodes.push({
                    ...node,
                    x: x,
                    y: layerYOffset + nodeSpacing * nodeIndex,
                    radius: sizeMap[node.size],
                    layer: layerIndex,
                    color: nodeColors[layerIndex]
                });
            });
        });
        
        // Create links between all nodes in adjacent layers
        const links = [];
        for (let l = 0; l < layers.length - 1; l++) {
            layers[l].nodes.forEach(sourceNode => {
                layers[l + 1].nodes.forEach(targetNode => {
                    links.push({
                        source: sourceNode.id,
                        target: targetNode.id
                    });
                });
            });
        }
        
        const svg = d3.select('#network')
            .attr('width', width)
            .attr('height', height);
        
        const g = svg.append('g');
        
        // Create links
        const link = g.append('g')
            .selectAll('path')
            .data(links)
            .enter().append('path')
            .attr('class', 'link')
            .attr('d', d => {
                const source = nodes.find(n => n.id === d.source);
                const target = nodes.find(n => n.id === d.target);
                // Create curved paths for more organic look
                const midX = (source.x + target.x) / 2;
                return `M ${source.x} ${source.y} Q ${midX} ${source.y} ${midX} ${(source.y + target.y) / 2} T ${target.x} ${target.y}`;
            });
        
        // Create node groups
        const nodeGroup = g.append('g')
            .selectAll('g')
            .data(nodes)
            .enter().append('g')
            .attr('transform', d => `translate(${d.x}, ${d.y})`);
        
        // Add circles
        const node = nodeGroup.append('circle')
            .attr('class', 'node')
            .attr('r', d => d.radius)
            .attr('fill', d => d.color)
            .attr('stroke', 'var(--color-text-light)')
            .attr('stroke-width', 2)
            .attr('opacity', 0.9)
            .on('click', (event, d) => {
                window.location.href = d.link;
            });
        
        // Add text with better styling
        const text = nodeGroup.append('text')
            .attr('class', 'node-text')
            .text(d => d.title)
            .style('font-size', d => {
                if (isMobile) {
                    return d.size === 'small' ? '10px' : d.size === 'medium' ? '12px' : '14px';
                }
                return d.size === 'small' ? '12px' : d.size === 'medium' ? '14px' : '16px';
            })
            .style('opacity', d => d.size === 'large' ? 1 : 0);
        
        // Zoom functionality
        let currentScale = 1;
        const zoom = d3.zoom()
            .scaleExtent([0.3, 5])
            .on('zoom', (event) => {
                g.attr('transform', event.transform);
                currentScale = event.transform.k;
                
                // Show text based on zoom level and node size
                text.transition()
                    .duration(200)
                    .style('opacity', d => {
                        if (d.size === 'large') return 1;
                        if (d.size === 'medium' && currentScale > 1.0) return 1;
                        if (d.size === 'small' && currentScale > 1.8) return 1;
                        return 0;
                    })
                    .style('font-size', d => {
                        const baseSize = isMobile 
                            ? (d.size === 'small' ? 10 : d.size === 'medium' ? 12 : 14)
                            : (d.size === 'small' ? 12 : d.size === 'medium' ? 14 : 16);
                        return `${baseSize / Math.sqrt(currentScale)}px`;
                    });
            });
        
        svg.call(zoom);
        
        // Add pulsing animation to links with smoother transitions
        function animateLinks() {
            link.transition()
                .duration(3000)
                .attr('stroke-opacity', 0.1)
                .transition()
                .duration(3000)
                .attr('stroke-opacity', 0.3)
                .on('end', animateLinks);
        }
        animateLinks();
        
        // Responsive
        window.addEventListener('resize', () => {
            location.reload(); // Simple solution to recalculate positions
        });
    </script>
</body>
</html>
